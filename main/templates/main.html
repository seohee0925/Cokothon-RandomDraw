<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>추억뽑기</title>
    <style>
        @font-face { font-family: 'yangjin'; src: url('https://cdn.jsdelivr.net/gh/supernovice-lab/font@0.9/yangjin.woff') format('woff'); font-weight: 100; font-style: normal; }
        /* 회전 애니메이션*/
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(90deg); }
            50% { transform: rotate(180deg); }
            75% { transform: rotate(270deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes shaker{
            0% { transform: rotate(10deg); }
            100% { transform: rotate(-10deg); }
        }
        
        /* rotate 클래스를 적용하면 회전 애니메이션이 적용됩니다. */
        .rotate {
            animation: rotate 3s linear infinite;
        }
        .shaker {
            animation: shaker 0.5s ease-in-out infinite alternate;
        }
    </style>
</head>
<body style="background: #D6C4A3; align-items: center; justify-self: center;">
    <div>
        <div class="Rectangle16" style="width: 257px; height: 168px; left: 591px; top: 518px; position: absolute; background: #C61511; border-radius: 22px; border: 5px black solid"></div>
        <div class="Rectangle21" style="left: 740px; top: 548px; position: absolute;">
        <image src="case.png" width="90"></div>
            <button class="Rectangle32" style="left: 632px; top: 550px; position: absolute; background: none; border: none; padding: 0; cursor: pointer; z-index: 2" onclick="sharot()">
                <img src="putcoin.png" width="90" alt="Put Coin">
            </button>
        <div style="width: 281px; height: 298px; left: 579px; top: 185px; position: absolute;">
            <image src="cover.png" class="cover" width="290"></div>
        <div class="Ellipse11" style="left: 580px; top: 420px; position: absolute;">
            <image src="Group 8.png" id="cap1" width="120"></div>
        <div class="Ellipse19" style="left: 750px; top: 425px; position: absolute;">
            <image src="Group 9.png" id="cap2" width="120"></div>
        <div class="Ellipse17" style="left: 670px; top: 400px; position: absolute;">
            <image src="Group 10.png" id="cap3" width="110"></div>
        <div class="Ellipse15" style=" left: 730px; top: 340px; position: absolute;">
            <image src="Group 11.png" id="cap4" width="120"></div>
        <div class="Ellipse21" style="left: 615px; top: 340px; position: absolute;">
            <image src="Group 12.png" id="cap5" width="90"></div>
        <div class="Ellipse13" style="left: 673px; top: 272px; position: absolute;">
            <image src="Group 13.png" id="cap6" width="120"></div>
        <div class="Rectangle45" style="width: 720px; height: 630px; left: 357px; top: 89px; position: absolute; background: rgba(217, 217, 217, 0); border-radius: 50px; border: 10px #734B45 solid"></div>
        <div class="Rectangle46" style="width: 683px; height: 600px; left: 377px; top: 108px; position: absolute; background: rgba(217, 217, 217, 0); border-radius: 50px; border: 5px #734B45 solid"></div>
        <div class="Rectangle47" style="width: 260px; height: 80px; left: 589px; top: 60px; position: absolute; background: #D6C4A3; border: 7px #734B45 solid"></div>
        <div style="width: 200px; height: 63px; left: 640px; top: 79px; position: absolute; color: #734B45; font-size: 45px; font-family: 'yangjin'; font-weight: 600; word-wrap: break-word">추억 뽑기</div>
        <div class="Ellipse22" style="width: 73px; height: 70px; left: 1290px; top: 25px; position: absolute; background: white; border-radius: 9999px"></div>
        <div style="width: 54px; height: 34px; left: 1230px; top: 46px; position: absolute; color: #F5F5F5; font-size: 25px; font-family: 'yangjin'; font-weight: 600; word-wrap: break-word">별명</div>
        <div style="left: 1170px; top: 110px; position: absolute; color: black; font-size: 22px; font-family: 'yangjin'; font-weight: 600; word-wrap: break-word">
        <image src="coin.png" width="100"></div>
        <div style="width: 146px; height: 36px; left: 1280px; top: 130px; position: absolute; color: black; font-size: 32px; font-family: 'yangjin'; font-weight: 600; word-wrap: break-word" id="amount">1000원</div>
        <div class="Frame1" style="width: 100px; height: 100px; left: 632px; top: 189px; position: absolute"></div>
    </div>

    <script>
        let amount=1000;
        function sharot() {
            // 회전할 이미지들
            if (amount < 500) {
        alert('동전이 부족해요. 편지를 쓰러갈까요?');
        return; // 함수 종료
            }
            else {
                amount-=500;
                updateAmount(amount);

            }
            const shImages = document.getElementsByClassName('cover');
            const capImages = [
                document.getElementById('cap1'),
                document.getElementById('cap2'),
                document.getElementById('cap3'),
                document.getElementById('cap4'),
                document.getElementById('cap5'),
                document.getElementById('cap6')
            ];

            Array.from(shImages).forEach((shImage) => {
            shImage.classList.add('shaker'); //shaker 클래스를 추가하여 애니메이션 적용
        });
        // 각 이미지에 대해 효과 적용
        capImages.forEach((cap, index) => {
                cap.classList.add('rotate'); // rotate 클래스를 추가하여 회전 애니메이션 적용
            });
            

        // 3초 후 rotate 클래스 제거
        setTimeout(() => {
            Array.from(shImages).forEach((shImage) => {
                shImage.classList.remove('shaker');// shaker 클래스를 제거하여 애니메이션 중지
                });
            }, 3000);

            setTimeout(() => {
                capImages.forEach((cap) => {
                    cap.classList.remove('rotate'); // rotate 클래스를 제거하여 애니메이션 중지
                    showcapsule();
                });
            }, 3000);
        }
        function showcapsule() {
    // 캔버스 생성
    const canvas = document.createElement('canvas');
    canvas.width = 900;
    canvas.height = 900;
    canvas.style.position = 'absolute';
    canvas.style.zIndex = '3';
    document.body.appendChild(canvas);

    const ctx = canvas.getContext('2d');

    // 이미지 가져오기
    const image = new Image();
    image.src = 'capsules.png'; // 이미지 경로 설정

    // 초기값 설정
    let imageSize = 50;
    let x = 740;
    let y = 548;
    let opacity = 0;    

    // 애니메이션 함수
    function animate() {
        // 캔버스 클리어
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        
        // 이미지 그리기
        ctx.globalAlpha = opacity;
        ctx.drawImage(image, x, y, imageSize, imageSize);
        ctx.globalAlpha = 1; // 원래 상태로 돌려놓기

        // 이미지 크기 증가
        imageSize += 2;

        // 이미지 이동
        y -= 2.5;
        x-=1.4;

        // 투명도 증가
        opacity += 0.01;

        // 특정 위치에 도달하면 애니메이션 중단
        if (imageSize>= 300) { 
            return;
        }
        canvas.addEventListener('click', function () {
                // 이미지 클릭 시 숨기고 함수 종료
                canvas.style.display = 'none';
            });
        // 애니메이션 프레임 요청
        requestAnimationFrame(animate);
    }

    // 이미지 로딩 후 애니메이션 시작
    image.onload = function () {
        animate();
    };
}

function updateAmount(newAmount) {
        const amountElement = document.getElementById('amount');
        if (amountElement) {
            amountElement.textContent = newAmount + '원';
        }
    }

    </script>
</body>
</html>
